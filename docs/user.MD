# å¾Œç«¯ API èªªæ˜ï¼ˆæä¾›çµ¦å‰ç«¯ï¼‰

æœ¬å°ˆæ¡ˆå¾Œç«¯ä½¿ç”¨ **Django + Django REST Framework + Simple JWT**ï¼Œæ‰€æœ‰ API æ¡ **JSON** å‚³è¼¸ã€‚

> æœ¬æ–‡ä»¶åƒ…æ¶µè“‹ã€Œä½¿ç”¨è€…èªè­‰ã€ç«¯é»ï¼›**ç›®å‰ä¸å•Ÿç”¨ reCAPTCHA**ã€‚

---

## ä½¿ç”¨è€…è¨»å†Š API

**è·¯å¾‘**ï¼š`POST /auth/signup/`

**èªªæ˜**ï¼šå»ºç«‹æ–°ä½¿ç”¨è€…å¸³è™Ÿã€‚

### è«‹æ±‚æ ¼å¼ï¼ˆJSONï¼‰

| æ¬„ä½å          | å‹åˆ¥     |  å¿…å¡« | èªªæ˜                                                          |
| ------------ | ------ | :-: | ----------------------------------------------------------- |
| `username`   | string |  âœ…  | æœ€å¤š 150 å­—å…ƒï¼Œ**å”¯ä¸€**                                            |
| `password`   | string |  âœ…  | ä½¿ç”¨è€…å¯†ç¢¼ï¼ˆå¾Œç«¯æœƒé›œæ¹Šå„²å­˜ï¼‰                                              |
| `email`      | string |  âœ…  | æœ‰æ•ˆ Emailï¼Œ**å”¯ä¸€**                                             |
| `real_name`  | string |  âœ…  | æœ€å¤š 150 å­—å…ƒ                                                   |
| `role`   | string |  âœ…  | èº«åˆ†ï¼š`teacher` / `admin` / `student`ï¼ˆ**å¿…å¡«**ï¼›æ¨¡å‹é è¨­ä»ç‚º `student`ï¼‰ |
| `student_id` | string |  âŒ  | æœ€å¤š 50 å­—å…ƒï¼ˆå”¯ä¸€ï¼‰ã€‚è‹¥ç„¡å¯çœç•¥                                          |
| `bio`        | string |  âŒ  | è‡ªæˆ‘ä»‹ç´¹                                                        |

**è«‹æ±‚ç¯„ä¾‹**ï¼š

```json
{
  "username": "momo",
  "email": "momo@example.com",
  "password": "abc12345",
  "real_name": "å°æ¡ƒ",
  "role": "student",
  "student_id": "1160001",
  "bio": "æˆ‘æ„›å¨ƒå¨ƒ"
}
```

**æˆåŠŸå›æ‡‰ï¼ˆ201, JSONï¼‰** ï¼Šå›å‚³æ¬„ä½å¯èƒ½ä¾å¾Œç«¯åºåˆ—åŒ–èª¿æ•´ï¼Œ`password` ä¸æœƒå›å‚³ï¼š

```json
{
  "id": "b1b6c3f4-6e9b-4bfa-9a78-9e1d1e6b8a21",
  "username": "momo",
  "email": "momo@example.com",
  "real_name": "å°æ¡ƒ",
  "role": "student",
  "date_joined": "2025-10-03T07:15:14.123Z",
  "last_login": null
}
```

**å¤±æ•—å›æ‡‰ï¼ˆ400, JSONï¼‰**

* å·²å­˜åœ¨ï¼š

  ```json
  {"username":["é€™å€‹ username åœ¨ user å·²ç¶“å­˜åœ¨ã€‚"],"email":["é€™å€‹ email åœ¨ user å·²ç¶“å­˜åœ¨ã€‚"]}
  ```
* `username` æœªå¡«ï¼š

  ```json
  {"username":["æ­¤ç‚ºå¿…éœ€æ¬„ä½ã€‚"]}
  ```
* Email æ ¼å¼éŒ¯èª¤ï¼š

  ```json
  {"email":["è«‹è¼¸å…¥æœ‰æ•ˆçš„é›»å­éƒµä»¶åœ°å€ã€‚"]}
  ```
* `role` æœªå¡«æˆ–å€¼éŒ¯èª¤ï¼š

  ```json
  {"role":["æ­¤ç‚ºå¿…éœ€æ¬„ä½ã€‚æˆ–å€¼å¿…é ˆç‚º teacher/admin/student ä¹‹ä¸€"]}
  ```

**cURL æ¸¬è©¦**ï¼š

```bash
curl -X POST http://127.0.0.1:8000/auth/signup/ \
  -H "Content-Type: application/json" \
  -d '{
    "username":"momo",
    "email":"momo@example.com",
    "password":"abc12345",
    "real_name":"å°æ¡ƒ",
    "role":"student"
  }'
```

---

## ä½¿ç”¨è€…ç™»å…¥ API

**è·¯å¾‘**ï¼š`POST /auth/session/`

**èªªæ˜**ï¼šä»¥å¸³è™Ÿå¯†ç¢¼ç™»å…¥ï¼Œå–å¾— JWTã€‚

### è«‹æ±‚æ ¼å¼ï¼ˆJSONï¼‰

| æ¬„ä½å        | å‹åˆ¥     |  å¿…å¡« | èªªæ˜                    |
| ---------- | ------ | :-: | --------------------- |
| `username` | string |  âœ…  | ç™»å…¥å¸³è™Ÿï¼ˆç›®å‰ä»¥ username ç™»å…¥ï¼‰ |
| `password` | string |  âœ…  | å¯†ç¢¼                    |

**æˆåŠŸè«‹æ±‚ç¯„ä¾‹**ï¼š

```json
{ "username": "momo", "password": "abc12345" }
```

**æˆåŠŸå›æ‡‰ï¼ˆ200, JSONï¼‰**

```json
{ "refresh": "<refresh.jwt>", "access": "<access.jwt>" }
```

**å¤±æ•—å›æ‡‰**

* èªè­‰å¤±æ•—ï¼ˆ401ï¼‰ï¼š

  ```json
  { "detail": "No active account found with the given credentials" }
  ```
* ç¼ºå°‘æ¬„ä½ï¼ˆ400ï¼‰ï¼š

  ```json
  { "username": ["This field is required."] }
  ```

**cURL æ¸¬è©¦**ï¼š

```bash
curl -X POST http://127.0.0.1:8000/auth/session/ \
  -H "Content-Type: application/json" \
  -d '{"username":"momo","password":"abc12345"}'
```

> æ¬„ä½èªªæ˜ï¼š
>
> * `access`ï¼šçŸ­æ•ˆ tokenï¼Œä¹‹å¾Œçš„ API éœ€å¸¶ `Authorization: Bearer <access>`ã€‚
> * `refresh`ï¼šç”¨æ–¼åœ¨ access éæœŸæ™‚æ›å–æ–° accessã€‚

---

## Refresh Token API

**è·¯å¾‘**ï¼š`POST /auth/refresh/`

**èªªæ˜**ï¼šä½¿ç”¨ç¾æœ‰çš„ refresh token å–å¾—æ–°çš„ access tokenã€‚

### è«‹æ±‚æ ¼å¼ï¼ˆJSONï¼‰

| æ¬„ä½å       | å‹åˆ¥     |  å¿…å¡« | èªªæ˜                     |
| --------- | ------ | :-: | ---------------------- |
| `refresh` | string |  âœ…  | å…ˆå‰ç™»å…¥æ™‚å–å¾—çš„ refresh token |

**æˆåŠŸè«‹æ±‚ç¯„ä¾‹**ï¼š

```json
{ "refresh": "<refresh.jwt>" }
```

**æˆåŠŸå›æ‡‰ï¼ˆ200, JSONï¼‰**

```json
{ "access": "<new.access.jwt>" }
```

> è‹¥ä¼ºæœå™¨è¨­å®š `ROTATE_REFRESH_TOKENS = True`ï¼Œå‰‡å›æ‡‰ä¸­ä¹Ÿå¯èƒ½åŒæ™‚åŒ…å«æ–°çš„ refresh tokenï¼š
>
> ```json
> { "access": "<new.access.jwt>", "refresh": "<new.refresh.jwt>" }
> ```

**å¤±æ•—å›æ‡‰**

* refresh token éºå¤±æˆ–ç„¡æ•ˆï¼ˆ401ï¼‰ï¼š

  ```json
  { "detail": "Token is invalid or expired", "code": "token_not_valid" }
  ```

* ç¼ºå°‘æ¬„ä½ï¼ˆ400ï¼‰ï¼š

  ```json
  { "refresh": ["This field is required."] }
  ```

**cURL æ¸¬è©¦**ï¼š

```bash
curl -X POST http://127.0.0.1:8000/auth/refresh/ \
  -H "Content-Type: application/json" \
  -d '{"refresh":"<refresh.jwt>"}'
```

> æ¬„ä½èªªæ˜ï¼š
>
> * `refresh`ï¼šç™»å…¥æ™‚ç™¼æ”¾çš„é•·æ•ˆ tokenï¼Œç”¨æ–¼æ›å–æ–°çš„ accessã€‚
> * `access`ï¼šçŸ­æ•ˆ tokenï¼Œç”¨æ–¼ API èªè­‰ï¼ŒéæœŸæ™‚éœ€é‡æ–°ä»¥ refresh æ›å–ã€‚

---

## Verify Token API

**è·¯å¾‘**ï¼š`POST /auth/verify/`

**èªªæ˜**ï¼šé©—è­‰æŒ‡å®šçš„ access token æ˜¯å¦æœ‰æ•ˆï¼ˆæœªéæœŸã€æœªç«„æ”¹ï¼‰ã€‚

### è«‹æ±‚æ ¼å¼ï¼ˆJSONï¼‰

| æ¬„ä½å     | å‹åˆ¥     |  å¿…å¡« | èªªæ˜                |
| ------- | ------ | :-: | ----------------- |
| `token` | string |  âœ…  | è¦é©—è­‰çš„ access token |

**æˆåŠŸè«‹æ±‚ç¯„ä¾‹**ï¼š

```json
{ "token": "<access.jwt>" }
```

**æˆåŠŸå›æ‡‰ï¼ˆ200, JSONï¼‰**

```json
{}
```

> è¡¨ç¤ºè©² access token æœ‰æ•ˆã€‚

**å¤±æ•—å›æ‡‰**

* token ç„¡æ•ˆæˆ–éæœŸï¼ˆ401ï¼‰ï¼š

  ```json
  { "detail": "Token is invalid or expired", "code": "token_not_valid" }
  ```

* ç¼ºå°‘æ¬„ä½ï¼ˆ400ï¼‰ï¼š

  ```json
  { "token": ["This field is required."] }
  ```

**cURL æ¸¬è©¦**ï¼š

```bash
curl -X POST http://127.0.0.1:8000/auth/verify/ \
  -H "Content-Type: application/json" \
  -d '{"token":"<access.jwt>"}'
```

> æ¬„ä½èªªæ˜ï¼š
>
> * `token`ï¼šæ¬²é©—è­‰çš„ access tokenã€‚è‹¥ token å·²éæœŸã€è¢«ä¿®æ”¹æˆ–ä¸åˆæ³•ï¼Œä¼ºæœå™¨æœƒå›å‚³ 401 éŒ¯èª¤ã€‚

---

## Revoke Refresh Tokenï¼ˆç™»å‡ºï¼‰

**è·¯å¾‘**ï¼š`POST /auth/session/revoke/`

**ç”¨é€”**ï¼šè¨»éŠ·ï¼ˆæ’¤éŠ·ï¼‰ä¸€é¡† **refresh token**ï¼Œä½¿å…¶ç„¡æ³•å†æ›ç™¼æ–°çš„ access tokenã€‚

**æ¬Šé™**ï¼š`Authorization: Bearer <access>`ï¼ˆ`IsAuthenticated`ï¼‰

### è«‹æ±‚ï¼ˆJSONï¼‰

| æ¬„ä½å       | å‹åˆ¥     |  å¿…å¡« | èªªæ˜                                                                                                 |
| --------- | ------ | :-: | -------------------------------------------------------------------------------------------------- |
| `refresh` | string |  âœ…  | å…ˆå‰ç™»å…¥æˆ– refresh æ™‚å–å¾—çš„ refresh tokenã€‚ |

**æˆåŠŸè«‹æ±‚ç¯„ä¾‹**ï¼š

```json
{ "refresh": "<refresh.jwt>" }
```

### æˆåŠŸå›æ‡‰

```
HTTP/1.1 205 Reset Content
```

> ä»£è¡¨è©² refresh å·²åŠ å…¥é»‘åå–®ã€‚å»ºè­°å‰ç«¯ç«‹å³æ¸…é™¤æœ¬åœ°æ†‘è­‰èˆ‡ç‹€æ…‹ã€‚

### å¤±æ•—å›æ‡‰

* ç¼ºå°‘æ¬„ä½ï¼ˆ400ï¼‰ï¼š

  ```json
  { "detail": "refresh field required" }
  ```
* refresh ç„¡æ•ˆæˆ–éæœŸï¼ˆ400ï¼‰ï¼š

  ```json
  { "detail": "Invalid or expired refresh token" }
  ```
* æœªæˆæ¬Šï¼ˆ401ï¼‰ï¼š

  ```json
  { "detail": "Authentication credentials were not provided." }
  ```

### cURL æ¸¬è©¦

```bash
ACCESS="<access.jwt>"
REFRESH="<refresh.jwt>"

curl -i -X POST "http://127.0.0.1:8000/auth/session/revoke/" \
  -H "Authorization: Bearer $ACCESS" \
  -H "Content-Type: application/json" \
  -d "{\"refresh\":\"$REFRESH\"}"
```

---

### ç›¸é—œç«¯é»å°ç…§

| åŠŸèƒ½         | è·¯å¾‘                      | æ–¹æ³•       | èªªæ˜                                               |
| ---------- | ----------------------- | -------- | ------------------------------------------------ |
| ç™»å…¥         | `/auth/session/`        | POST     | SimpleJWT å–å¾— `access` + `refresh`                |
| Refresh    | `/auth/refresh/`        | POST     | ç”¨ `refresh` æ›æ–° `access`ï¼›è‹¥å•Ÿç”¨ rotateï¼Œæœƒå›æ–° `refresh` |
| Verifyï¼ˆå¯é¸ï¼‰ | `/auth/verify/`         | POST     | é©—è­‰ `access` æ˜¯å¦æœ‰æ•ˆï¼ˆæœ‰æ•ˆæ™‚å› `{}`ï¼‰                      |
| **å®‰å…¨ç™»å‡º**   | `/auth/session/revoke/` | **POST** | å°‡ `refresh` åŠ å…¥é»‘åå–®ï¼ˆç«‹å³å¤±æ•ˆï¼‰                          |

---

### ç¯„ä¾‹ä½¿ç”¨æƒ…å¢ƒï¼ˆç”¨æˆ¶æŒ‰ã€Œç™»å‡ºã€ï¼‰

1. å‰ç«¯å‘¼å« `POST /auth/session/revoke/`ï¼ˆå¸¶ accessï¼›body å¸¶ refresh æˆ–ç”± cookie å–ï¼‰ã€‚
2. æ”¶åˆ° `205` â‡’ æ¸…é™¤æœ¬åœ° `access/refresh`ã€åœæ­¢è‡ªå‹• refreshã€è·³è½‰ç™»å…¥ã€‚
3. è‹¥ç”¨æˆ¶è¿”å›é é¢ä¸” access éæœŸï¼Œæ””æˆªå™¨åˆ¤å®š 401 â†’ å˜—è©¦ `/auth/refresh/`ï¼›è‹¥å¾Œç«¯å› `token_not_valid / blacklisted` â‡’ ç›´æ¥è·³è½‰ç™»å…¥ã€‚

---

## GET /auth/me/

**è·¯å¾‘**ï¼š`GET /auth/me/`

**èªªæ˜**ï¼š
ä½¿ç”¨ç›®å‰ç™»å…¥ç‹€æ…‹ï¼ˆAuthorization Header å¸¶å…¥ `Bearer <access>`ï¼‰å–å¾—ç•¶å‰ä½¿ç”¨è€…çš„åŸºæœ¬è³‡æ–™ï¼ŒåŒ…å« `user_id`ã€`username`ã€`email`ã€`role`ã€‚

### è«‹æ±‚æ ¼å¼

æ­¤ API ç‚º `GET`ï¼Œä¸éœ€è«‹æ±‚ bodyï¼Œä½†å¿…é ˆåœ¨ Header å¸¶å…¥ JWT access tokenã€‚

**HTTP Header å¿…å¡«é …ï¼š**

| æ¬„ä½å             | å‹åˆ¥     |  å¿…å¡« | èªªæ˜                          |
| --------------- | ------ | :-: | --------------------------- |
| `Authorization` | string |  âœ…  | æ ¼å¼ç‚º `Bearer <access_token>` |

**è«‹æ±‚ç¯„ä¾‹ï¼ˆä¸å« bodyï¼‰**ï¼š

```http
GET /auth/me/ HTTP/1.1
Host: 127.0.0.1:8000
Authorization: Bearer <ACCESS_TOKEN>
```

---

### æˆåŠŸå›æ‡‰ï¼ˆ200, JSONï¼‰

```json
{
  "status": "ok",
  "message": "Get current user",
  "data": {
    "user_id": "f07e9f90-89c3-49a6-b241-2fe8f73ff80b",
    "username": "momo",
    "email": "momo@example.com",
    "role": "student"
  }
}
```

å„æ¬„ä½èªªæ˜ï¼š

| è·¯å¾‘              | å‹åˆ¥     | èªªæ˜                 |
| --------------- | ------ | ------------------ |
| `status`        | string | ç‹€æ…‹å­—ä¸²ï¼ŒæˆåŠŸå›ºå®šç‚º `"ok"`  |
| `message`       | string | æè¿°è¨Šæ¯               |
| `data.user_id`   | string | ä½¿ç”¨è€…åœ¨ç³»çµ±ä¸­çš„å”¯ä¸€ ID      |
| `data.username` | string | ä½¿ç”¨è€…å¸³è™Ÿ              |
| `data.email`    | string | ä½¿ç”¨è€…è¨»å†Š email        |
| `data.role`     | string | ä½¿ç”¨è€…è§’è‰²ï¼ˆå¦‚ï¼š`student`ï¼‰ |

---

### å¤±æ•—å›æ‡‰ç¯„ä¾‹

* æœªå¸¶ token æˆ– token ç„¡æ•ˆï¼ˆ401ï¼‰ï¼š

  ```json
  {
    "detail": "Authentication credentials were not provided."
  }
  ```

  æˆ–

  ```json
  {
    "detail": "Given token not valid for any token type",
    "code": "token_not_valid"
  }
  ```

---

### cURL æ¸¬è©¦ç¯„ä¾‹

```bash
curl -X GET "http://127.0.0.1:8000/auth/me/" \
  -H "Authorization: Bearer <ACCESS_TOKEN>"
```

> ä½¿ç”¨èªªæ˜ï¼š
>
> * å»ºè­°ç™»å…¥å¾Œï¼ˆå‘¼å« `POST /auth/session/` æ‹¿åˆ° accessï¼‰å°±ç«‹åˆ»å‘¼å«ä¸€æ¬¡ `GET /auth/me/`ï¼Œ
>   å°‡å›å‚³çš„ `user_id`ã€`username`ã€`email`ã€`role` å­˜åˆ°å‰ç«¯çš„å…¨åŸŸç‹€æ…‹ï¼ˆä¾‹å¦‚ Redux / Zustand / Vuexï¼‰ï¼Œä½œç‚ºä¹‹å¾Œé¡¯ç¤ºä½¿ç”¨è€…åç¨±æˆ–åˆ¤æ–·è§’è‰²æ¬Šé™ä¹‹ç”¨ã€‚
> * è‹¥æ”¶åˆ° 401ï¼Œè«‹å…ˆç¢ºèª access token æ˜¯å¦éæœŸï¼Œå¯æ­é… `POST /auth/refresh/` é‡æ–°å–å¾—æ–°çš„ accessã€‚

---

## GET /profile/

**èªªæ˜**ï¼š
å–å¾—ç›®å‰ç™»å…¥ä½¿ç”¨è€…çš„å€‹äººè³‡æ–™ã€‚

**æ¬Šé™éœ€æ±‚**ï¼š

* éœ€è¦ç™»å…¥ï¼ˆJWT Access Tokenï¼‰

**Request Header**ï¼š

| Header        | Type   | Required | èªªæ˜                          |
| ------------- | ------ | -------- | --------------------------- |
| Authorization | string | âœ…        | æ ¼å¼ç‚º `Bearer <ACCESS_TOKEN>` |
| Content-Type  | string | âœ…        | `application/json`          |

**Request Body**ï¼š
ç„¡

---

### Response

**æˆåŠŸç¯„ä¾‹ (200 OK)**

```json
{
  "real_name": "é™³å¤©å¤©",
  "username": "momo",
  "role": "Student",
  "email": "412470100S@gapps.ntnu.edu.tw",
  "user_id": "omuba",
  "student_id": "41247057S",
  "bio": "å“ˆå›‰æˆ‘æ˜¯è³‡å·¥116",
  "avatar":null
}
```

**æ¬„ä½èªªæ˜**ï¼š

| æ¬„ä½           | å‹åˆ¥     | èªªæ˜                               |
| ------------ | ------ | -------------------------------- |
| real_name    | string | ä½¿ç”¨è€…çœŸå¯¦å§“å                          |
| username    | string | ä½¿ç”¨è€…å¸³è™Ÿï¼ˆusernameï¼‰                  |
| role         | string | ä½¿ç”¨è€…èº«ä»½ï¼ˆStudent / Teacher / Adminï¼‰ |
| email        | string | ä½¿ç”¨è€…é›»å­éƒµä»¶                          |
| user_id      | string | ä½¿ç”¨è€…çš„ ID             |
| student_id   | string | å­¸è™Ÿï¼ˆè‹¥æœ‰ï¼‰                           |
| bio | string | å€‹äººç°¡ä»‹                             |
| avatar       | string | é ­åƒ url                |

---

### éŒ¯èª¤å›æ‡‰

| ç‹€æ…‹ç¢¼              | èªªæ˜            | ç¯„ä¾‹                                                                   |
| ---------------- | ------------- | -------------------------------------------------------------------- |
| 401 Unauthorized | Token éºå¤±æˆ–ç„¡æ•ˆ   | `{ "detail": "Authentication credentials were not provided." }`      |
| 403 Forbidden    | ä½¿ç”¨è€…æ¬Šé™ä¸è¶³ï¼ˆè‹¥æœªç™»å…¥ï¼‰ | `{ "detail": "You do not have permission to perform this action." }` |

---

### æ¸¬è©¦æŒ‡ä»¤

```bash
curl -X GET http://127.0.0.1:8000/profile/ \
  -H "Authorization: Bearer <ACCESS_TOKEN>" \
  -H "Content-Type: application/json"
```

---

## GET /profile/{username}/

**èªªæ˜**
æŸ¥çœ‹**å…¶ä»–ä½¿ç”¨è€…**çš„å…¬é–‹å€‹äººè³‡æ–™ã€‚

> èˆ‡ `GET /profile/`ï¼ˆæŸ¥çœ‹è‡ªå·±çš„å®Œæ•´è³‡æ–™ï¼‰ä¸åŒï¼Œæœ¬ç«¯é»**ä¸æœƒ**å›å‚³ `real_name`ã€`student_id` ç­‰ç§å¯†æ¬„ä½ã€‚

---

### æ¬Šé™éœ€æ±‚

* éœ€è¦ç™»å…¥ï¼ˆJWT Access Tokenï¼‰

---

### Request

#### Method & URL

```
GET /profile/{username}/
```

#### Path Parameters

| åƒæ•¸å      | é¡å‹     | å¿…å¡« | èªªæ˜              |
| -------- | ------ | -- | --------------- |
| username | string | âœ…  | ç›®æ¨™ä½¿ç”¨è€…å¸³è™Ÿï¼ˆå¤§å°å¯«ä¸æ•æ„Ÿï¼‰ |

#### Headers

| Header        | é¡å‹     | å¿…å¡« | èªªæ˜                      |
| ------------- | ------ | -- | ----------------------- |
| Authorization | string | âœ…  | `Bearer <ACCESS_TOKEN>` |
| Content-Type  | string | âœ…  | `application/json`      |

#### Request Body

* ç„¡

---

#### æˆåŠŸå›æ‡‰ï¼ˆ200 OKï¼‰

```json
{
  "username": "momo",
  "role": "Student",
  "email": "momo@example.com",
  "user_id": "f07e9f90-89c3-49a6-b241-2fe8f73ff80b",
  "bio": "å“ˆå›‰æˆ‘æ˜¯è³‡å·¥116",
  "avatar":null
}
```

#### æ¬„ä½èªªæ˜

| æ¬„ä½           | é¡å‹     | èªªæ˜                                        |
| ------------ | ------ | ----------------------------------------- |
| username    | string | ä½¿ç”¨è€…å¸³è™Ÿï¼ˆusernameï¼‰                           |
| role         | string | ä½¿ç”¨è€…èº«ä»½ï¼ˆä¾‹å¦‚ï¼š`Student` / `Teacher` / `Admin`ï¼‰ |
| email        | string | ä½¿ç”¨è€…é›»å­éƒµä»¶ï¼ˆä¾éš±ç§ç­–ç•¥å¯èƒ½é¡¯ç¤ºæˆ–é®è”½ï¼‰                     |
| user_id      | string | ä½¿ç”¨è€…çš„å…¬é–‹ IDï¼ˆé è¨­ç‚ºä½¿ç”¨è€…ä¸»éµï¼›è‹¥ç³»çµ±æœ‰è‡ªè¨‚å…¬é–‹ ID å‰‡ç‚ºè©²å€¼ï¼‰      |
| bio | string | å€‹äººç°¡ä»‹ï¼ˆä¾†æºï¼šUserProfile.bioï¼›è‹¥æœªè¨­å®šå¯èƒ½ç‚ºç©ºå­—ä¸²ï¼‰       |
| avatar       | string | é ­åƒ url                |

> æ³¨æ„ï¼š**ä¸åŒ…å«** `real_name`ã€`student_id`ã€‚

---

### å¤±æ•—å›æ‡‰

#### 401 Unauthorizedï¼ˆæœªç™»å…¥æˆ– Token å¤±æ•ˆï¼‰

```json
{
  "detail": "Authentication credentials were not provided or are invalid."
}
```

#### 404 Not Foundï¼ˆæ‰¾ä¸åˆ°ä½¿ç”¨è€…ï¼‰

```json
{
  "detail": "User not found."
}
```

> å…¶ä»–éŒ¯èª¤ï¼ˆ5xxï¼‰å¤šåŠç‚ºä¼ºæœå™¨ç«¯ç•°å¸¸ï¼Œè«‹æª¢æŸ¥æ—¥èªŒã€‚

---

### ç¯„ä¾‹

#### cURL

```bash
curl -i -X GET "http://127.0.0.1:8000/profile/momo/" \
  -H "Authorization: Bearer <ACCESS_TOKEN>" \
  -H "Content-Type: application/json"
```

---

## POST /profile/

### èªªæ˜

æ›´æ–°ç™»å…¥ä½¿ç”¨è€…çš„å€‹äººè³‡æ–™ã€‚æ‰€æœ‰æ¬„ä½çš†ç‚ºéå¿…å¡«ï¼Œåƒ…æœƒæ›´æ–°è«‹æ±‚ä¸­æä¾›çš„æ¬„ä½ï¼Œå…¶é¤˜ä¿æŒä¸è®Šã€‚

å¯ä¿®æ”¹æ¬„ä½ï¼š

* `real_name`ï¼šçœŸå¯¦å§“åï¼ˆUserï¼‰
* `email`ï¼šEmailï¼ˆUserï¼‰
* `student_id`ï¼šå­¸è™Ÿï¼Œå¯ç©ºï¼ˆUserProfileï¼‰
* `bio`ï¼šå€‹äººç°¡ä»‹ï¼Œå¯ç©ºï¼ˆUserProfileï¼‰
* `avatar`ï¼šé ­åƒåœ–ç‰‡æª”æ¡ˆï¼Œå¯é¸ï¼ˆUserProfileï¼‰

ğŸ“Œ ä¸å«æª”æ¡ˆ â†’ ä½¿ç”¨ `application/json`
ğŸ“Œ å« `avatar` â†’ ä½¿ç”¨ `multipart/form-data`

---

## è«‹æ±‚æ ¼å¼

### JSONï¼ˆä¸å«æª”æ¡ˆï¼‰

```
POST /profile/
Content-Type: application/json
Authorization: Bearer <ACCESS_TOKEN>
```

```json
{
  "real_name": "æ–°åå­—",
  "email": "new_email@example.com",
  "student_id": "4103xxxx",
  "bio": "æ›´æ–°å¾Œçš„è‡ªæˆ‘ä»‹ç´¹"
}
```

### multipart/form-dataï¼ˆå« avatarï¼‰

```
POST /profile/
Content-Type: multipart/form-data
Authorization: Bearer <ACCESS_TOKEN>
```

æ¬„ä½ï¼š

* `avatar`: file
* `bio`: text
* å…¶é¤˜æ–‡å­—æ¬„ä½ï¼š`real_name`, `email`, `student_id`

---

## æˆåŠŸå›æ‡‰ï¼ˆ200ï¼‰

```json
{
  "data": {
    "real_name": "æ–°åå­—",
    "username": "momo",
    "role": "Student",
    "email": "new_email@example.com",
    "user_id": "f07e9f90-89c3-49a6-b241-2fe8f73ff80b",
    "student_id": "4103xxxx",
    "bio": "æ›´æ–°å¾Œçš„è‡ªæˆ‘ä»‹ç´¹",
    "avatar": "http://127.0.0.1:8000/media/avatars/xxx.png"
  },
  "message": "Profile updated",
  "status": "ok"
}
```

---

## å¤±æ•—å›æ‡‰ï¼ˆ400ï¼‰

```json
{
  "data": {
    "email": ["Enter a valid email address."],
    "avatar": ["The submitted file is empty."]
  },
  "message": "Validation error",
  "status": "error"
}
```

---

## curl ç¯„ä¾‹

### ä¿®æ”¹æ–‡å­—æ¬„ä½ï¼ˆJSONï¼‰

```bash
curl -X POST "http://127.0.0.1:8000/profile/" \
  -H "Authorization: Bearer $ACCESS" \
  -H "Content-Type: application/json" \
  -d '{
    "real_name": "å°æ¡ƒæ”¹åç‰ˆ",
    "email": "new_momo@example.com",
    "bio": "é€™æ˜¯æ–°çš„è‡ªä»‹ï¼"
  }'
```

### ä¸Šå‚³é ­åƒï¼ˆmultipart/form-dataï¼‰

```bash
curl -X POST "http://127.0.0.1:8000/profile/" \
  -H "Authorization: Bearer $ACCESS" \
  -F "avatar=@/home/rokusenn/Pictures/avatar.png" \
  -F "bio=æ›´æ–°éçš„è‡ªæˆ‘ä»‹ç´¹"
```
---
